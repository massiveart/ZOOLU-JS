Function.prototype.bind||(Function.prototype.bind=function(a){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a||window,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e});window.log=function(){this.log.history=this.log.history||[];this.log.history.push(arguments);this.console&&this.console.log(Array.prototype.slice.call(arguments))};window.debug=!1;(function(a,b,c){"use strict";function d(){a.debug&&a.log.apply(a,b.merge(["ZOOLU"],arguments))}var e;e={version:"2.0.0.alpha1"};a.ZOOLU=a.$z=e})(window,window.jQuery);(function(a,b,c,d){"use strict";function e(){a.debug&&a.log.apply(a,c.merge(["ZOOLU","UTIL"],arguments))}b.UTIL={};b.UTIL.String={truncate:function(a,b){e("String","truncate");return typeof a!="string"?"":a.length>b?a.slice(0,b-3)+"...":a},truncateAtWordBoundaries:function(a,b){e("String","truncateAtWordBoundaries");var c,d;if(typeof a!="string")return"";c=a.split("");if(c.length>b){for(d=c.length-1;d>-1;--d)if(d>b)c.length=d;else if(" "===c[d]){c.length=d;break}c.push(" ...")}return c.join("")},truncateInBetween:function(a,b,c){e("String","truncateAtTheMiddle");if(typeof a!="string")return"";if(a.length>b){c=c||" ... ";var d=c.length,f=b-d,g=Math.ceil(f/3*2),h=Math.floor(f/3*1);return a.substr(0,g)+c+a.substr(a.length-h)}return a}}})(window,window.ZOOLU,window.jQuery);(function(a,b,c,d){"use strict";function e(){a.debug&&a.log.apply(a,c.merge(["ZOOLU","MIXIN"],arguments))}b.MIXIN={};b.MIXIN.Events={enable:function(){this.listeners||(this.listeners={});this.trigger=function(a,c){b.MIXIN.Events.trigger.call(this,a,c)}.bind(this);this.on=function(a,c){b.MIXIN.Events.on.call(this,a,c)}.bind(this);this.off=function(a,c){b.MIXIN.Events.off.call(this,a,c)}.bind(this)},trigger:function(b,c){if(!!this.listeners[b])for(var d=-1,e=this.listeners[b].length;++d<e;)this.listeners[b][d].apply(a,c)},on:function(a,b){this.listeners[a]||(this.listeners[a]=[]);b instanceof Function&&this.listeners[a].push(b)},off:function(a,b){if(!!this.listeners[a]&&this.listeners[a].length>0)if(!b)this.listeners[a]=[];else{var c=[];for(var d=-1,e=this.listeners[a].length;++d<e;)b!==this.listeners[a][d]&&c.push(this.listeners[a][d]);this.listeners[a]=c}}}})(window,window.ZOOLU,window.jQuery);(function(a,b,c,d){"use strict";function e(){a.debug&&a.log.apply(a,c.merge(["ZOOLU","UI"],arguments))}b.UI={};b.UI.Exception=function(a){this.name="ZOOLU.UI.Exception";this.message=a||"Something went wrong!"};b.UI.Exception.prototype={constructor:b.UI.Exception,toString:function(){return this.name+': "'+this.message+'"'}};b.UI.ColumnTree=function(a,d){this.$container=c(a);if(!this.$container.length)throw new b.UI.Exception("ColumnTree container doesn't exist!");this.$container.addClass("column-tree");this.options=c.extend({hasChildren:{},urlAddOnForLoadingNodeChildren:"/children",rowMaxLength:30},d);this.level=0;this.selectedId=null;this.$selected=null;this.$currentColumn=null;this.data=[];b.MIXIN.Events.enable.call(this);e("ColumnTree","construct",this);this.load()};b.UI.ColumnTree.prototype={constructor:b.UI.ColumnTree,load:function(){e("ColumnTree","load");if(this.options.url){this.trigger("ColumnTree.load");this.$container.find(".column").length<=this.level&&this.addColumn();this.$currentColumn=c("#column-"+this.level);this.$currentColumn.addClass("busy");c.ajax({url:this.selectedId?this.options.url+"/"+this.selectedId+this.options.urlAddOnForLoadingNodeChildren:this.options.url,type:"GET",dataType:"JSON",success:function(a){e("ColumnTree","load","success",a);this.updateData(a);this.updateView()}.bind(this),error:function(a,b){e("ColumnTree","load","error",b);this.$currentColumn.removeClass("busy")}.bind(this)})}},updateData:function(a){e("ColumnTree","updateData");this.data[this.level]=a},updateView:function(){e("ColumnTree","updateView");if(!this.$currentColumn.length)throw new b.UI.Exception("Current column not found!");this.$currentColumn.removeClass("busy");this.$list=c('<ul class="list"/>');for(var a=-1,d=this.data[this.level].length;++a<d;)this.prepareRow(this.data[this.level][a]).appendTo(this.$list);this.$currentColumn.html(this.$list);delete this.$row;delete this.$list},addColumn:function(){e("ColumnTree","addColumn");this.$container.append(c('<div class="column"/>').attr("id","column-"+this.level).data("level",this.level))},prepareRow:function(a){e("ColumnTree","prepareRow",arguments);this.$row=c('<li class="row '+a.type+'"/>').attr("id","row-"+a.id+"-"+a.type);this.$row.html(b.UTIL.String.truncateInBetween(a.name,this.options.rowMaxLength));this.$row.data("id",a.id);this.$row.data("type",a.type);this.$row.data("level",this.level);this.attachRowObservers(a);return this.$row},attachRowObservers:function(){e("ColumnTree","attachRowObservers",arguments);this.$row.on("click",function(a){this.select(a.target)}.bind(this))},select:function(a){e("ColumnTree","select",arguments);this.$selected=c(a);this.trigger("ColumnTree.select",[this.$selected]);this.updateSelectedMarker();this.$selected.addClass("selected");this.selectedId=this.$selected.data("id");this.level=this.$selected.data("level");this.$container.find(".column").each(function(a,b){c(b).data("level")>this.level&&c(b).html("")}.bind(this));if(this.options.hasChildren.hasOwnProperty(this.$selected.data("type"))&&this.options.hasChildren[this.$selected.data("type")]===!0){this.level++;this.load()}},updateSelectedMarker:function(){}};b.UI.Layout=function(a,d){this.$container=c(a);if(!this.$container.length)throw new b.UI.Exception("Layout container doesn't exist!");this.$container.addClass("layout");this.panels=[];this.options=c.extend({fullPage:!0,possiblePanels:["west","north","center"],hasChildPanels:["center"]},d);b.MIXIN.Events.enable.call(this);e("Layout","construct",this);this.initialize()};b.UI.Layout.prototype={constructor:b.UI.Layout,initialize:function(){e("Layout","initialize");for(var a=-1,b=this.options.possiblePanels.length;++a<b;)this.$container.find("> ."+this.options.possiblePanels[a]).each(this.initPanel.bind(this))},initPanel:function(a,c){e("Layout","initPanel",arguments);this.addPanel(new b.UI.Layout.Panel(c,this.options))},addPanel:function(a){e("Layout","addPanel",arguments);this.panels.push(a)}};b.UI.Layout.Panel=function(a,d){this.$element=c(a);if(!this.$element.length)throw new b.UI.Exception("Panel doesn't exist!");this.$element.addClass("panel");this.options=c.extend({},d);b.MIXIN.Events.enable.call(this);e("Layout","Panel","construct",this)};b.UI.Layout.Panel.prototype={constructor:b.UI.Layout.Panel}})(window,window.ZOOLU,window.jQuery);